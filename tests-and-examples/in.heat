# Lammps Simulation: Sat Aug 26 07:06:47 2017

processors      * * 1
units           real
atom_style      full
dimension       3
boundary        p p f
read_data       ../DATA/data.N72onEH1_confined
include         ../DATA/forcefield.ZonH1
dielectric      1.0
pair_modify     shift yes mix sixthpower
special_bonds   lj/coul 0.0 0.0 1.0
neighbor        2.0 bin
neigh_modify    delay 0 one 5000
kspace_style    pppm 1e-5
kspace_modify   slab 3.0
neigh_modify    exclude type 4 4
neigh_modify    exclude type 4 6
neigh_modify    exclude type 4 8
neigh_modify    exclude type 4 10
neigh_modify    exclude type 4 12
neigh_modify    exclude type 4 14
neigh_modify    exclude type 4 16
neigh_modify    exclude type 6 6
neigh_modify    exclude type 6 8
neigh_modify    exclude type 6 10
neigh_modify    exclude type 6 12
neigh_modify    exclude type 6 14
neigh_modify    exclude type 6 16
neigh_modify    exclude type 8 8
neigh_modify    exclude type 8 10
neigh_modify    exclude type 8 12
neigh_modify    exclude type 8 14
neigh_modify    exclude type 8 16
neigh_modify    exclude type 10 10
neigh_modify    exclude type 10 12
neigh_modify    exclude type 10 14
neigh_modify    exclude type 10 16
neigh_modify    exclude type 12 12
neigh_modify    exclude type 12 14
neigh_modify    exclude type 12 16
neigh_modify    exclude type 14 14
neigh_modify    exclude type 14 16
neigh_modify    exclude type 16 16
neigh_modify    exclude type 5 5
neigh_modify    exclude type 5 7
neigh_modify    exclude type 5 9
neigh_modify    exclude type 5 11
neigh_modify    exclude type 5 13
neigh_modify    exclude type 5 15
neigh_modify    exclude type 5 17
neigh_modify    exclude type 7 7
neigh_modify    exclude type 7 9
neigh_modify    exclude type 7 11
neigh_modify    exclude type 7 13
neigh_modify    exclude type 7 15
neigh_modify    exclude type 7 17
neigh_modify    exclude type 9 9
neigh_modify    exclude type 9 11
neigh_modify    exclude type 9 13
neigh_modify    exclude type 9 15
neigh_modify    exclude type 9 17
neigh_modify    exclude type 11 11
neigh_modify    exclude type 11 13
neigh_modify    exclude type 11 15
neigh_modify    exclude type 11 17
neigh_modify    exclude type 13 13
neigh_modify    exclude type 13 15
neigh_modify    exclude type 13 17
neigh_modify    exclude type 15 15
neigh_modify    exclude type 15 17
neigh_modify    exclude type 17 17
timestep        1.0
run_style       respa 2 2 bond 1 angle 2 dihedral 2 improper 2 pair 2 kspace 2
group           lBase type 4
group           lBath type 6
group           lSurf type 14 16
group           lFree type 8 10 12 14 16
group           uBase type 5
group           uBath type 7
group           uSurf type 15 17
group           uFree type 9 11 13 15 17
group           lSolid union lBase lBath lFree
group           uSolid union uBase uBath uFree
group           liq molecule 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72
fix             NVE_all all nve
fix             freeze_lBase lBase setforce 0.0 0.0 0.0
fix             load_uBase uBase aveforce NULL NULL -0.0455
fix             freeZ_uBase uBase setforce 0.0 0.0 NULL
compute         tempZ_uBase uBase temp/partial 0 0 1
fix             damper_uBase uBase langevin 0 0 100 2017
fix_modify      damper_uBase temp tempZ_uBase
compute         noBiasTemp_lBath lBath temp/com
fix             heat_lBath lBath langevin 300 500 100 2017
fix_modify      heat_lBath temp noBiasTemp_lBath
compute         noBiasTemp_uBath uBath temp/com
fix             heat_uBath uBath langevin 300 500 100 2017
fix_modify      heat_uBath temp noBiasTemp_uBath
thermo          1000
thermo_style    multi
shell           mkdir dumps_all
dump            myDump_all all custom 10000 dumps_all/atom.*.dump id type xu yu zu vx vy vz
shell           mkdir dumps_liq
dump            myDump_liq liq custom 1000 dumps_liq/atom.*.dump id type xu yu zu vx vy vz
compute         atomK_all all ke/atom
variable        atomT atom c_atomK_all*335.514175
variable        atomicVx atom vx
compute         chunkZ_all all chunk/atom bin/1d z 0.0 1.0 bound z 0.0 100.0
fix             distroZ_all all ave/chunk 1 100000 100000 chunkZ_all v_atomT v_atomicVx file distroZ_all.dat
compute         chunkZ_liq liq chunk/atom bin/1d z 0.0 1.0 bound z 0.0 100.0
fix             distroZ_liq liq ave/chunk 1 100000 100000 chunkZ_liq v_atomT v_atomicVx file distroZ_liq.dat
variable        lBaseFx equal fcm(lBase,x)
variable        lSolidFx equal fcm(lSolid,x)
variable        uBaseFx equal fcm(uBase,x)
variable        uSolidFx equal fcm(uSolid,x)
variable        uBaseFz equal fcm(uBase,z)
variable        lSurfZ equal xcm(lSurf,z)
variable        uSurfZ equal xcm(uSurf,z)
variable        uFz2 equal v_uBaseFz*v_uBaseFz
variable        gap equal v_uSurfZ-v_lSurfZ
fix             SolVals_all all ave/time 1 1000 1000 v_lBaseFx v_lSolidFx v_uBaseFx v_uSolidFx v_uBaseFz v_lSurfZ v_uSurfZ v_uFz2 v_gap file Vals_sol.dat
compute         temp_liq liq temp
fix             LiqVals_all all ave/time 1 1000 1000 c_temp_liq file Vals_liq.dat
log             log.heat append
run             200000
write_data      data.N72onH1_Heat300K_heat nocoeff
log             log.stay append
unfix           heat_lBath
fix             thermo_lBath lBath langevin 500 500 100 2017
fix_modify      thermo_lBath temp noBiasTemp_lBath
unfix           heat_uBath
fix             thermo_uBath uBath langevin 500 500 100 2017
fix_modify      thermo_uBath temp noBiasTemp_uBath
run             2000000
write_data      data.N72onH1_Heat300K_stay nocoeff
